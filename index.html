<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>BoxTipping</title>
<style>
    body { margin:0; background:#111; color:white; font-family:Arial; }
    #game { background:#222; display:block; margin:0 auto; }
    #ui {
        position:fixed; top:10px; left:10px; font-size:20px;
        background:rgba(0,0,0,0.4); padding:10px; border-radius:6px;
    }
    #restartBtn {
        position:fixed; top:50%; left:50%;
        transform:translate(-50%, -50%);
        padding:15px 25px; font-size:20px;
        display:none; background:#f00; border:none; border-radius:8px;
        color:white; cursor:pointer;
    }
    #menuBtn {
        position:fixed; bottom:20px; right:20px;
        padding:12px 20px; font-size:18px;
        background:#444; border:none; border-radius:6px;
        color:white; cursor:pointer;
    }
</style>
</head>
<body>

<canvas id="game" width="400" height="600"></canvas>

<div id="ui">
    Score: <span id="score">0</span><br>
    Lives: <span id="lives">3</span><br>
    Level: <span id="level">1</span>
</div>

<button id="restartBtn">Restart</button>
<button id="menuBtn">Men√º</button>

<script>
// -------------------------------------------
// VARIABLES
// -------------------------------------------
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let score = 0;
let lives = 3;
let level = 1;

let gameRunning = true;
let gameLoopID = null;

// Player
const player = {
    x: 180,
    y: 550,
    w: 40,
    h: 40,
    speed: 6
};

// Enemy
let enemy = {
    x: 180,
    y: 0,
    w: 40,
    h: 40,
    speed: 2
};

// -------------------------------------------
// GAME LOOP
// -------------------------------------------
function gameLoop() {
    gameLoopID = requestAnimationFrame(gameLoop);
    if (!gameRunning) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Draw player
    ctx.fillStyle = "red";
    ctx.fillRect(player.x, player.y, player.w, player.h);

    // Move enemy
    enemy.y += enemy.speed;

    // Draw enemy
    ctx.fillStyle = "yellow";
    ctx.fillRect(enemy.x, enemy.y, enemy.w, enemy.h);

    // Collision
    if (
        enemy.y + enemy.h >= player.y &&
        enemy.x < player.x + player.w &&
        enemy.x + enemy.w > player.x
    ) {
        lives--;
        document.getElementById("lives").innerText = lives;
        resetEnemy();

        if (lives <= 0) endGame();
    }

    // Enemy passed bottom
    if (enemy.y > 600) {
        score += 10;
        document.getElementById("score").innerText = score;
        resetEnemy();
    }
}

function resetEnemy() {
    enemy.y = -40;
    enemy.x = Math.random() * 360;
}

// -------------------------------------------
// ENDGAME
// -------------------------------------------
function endGame() {
    gameRunning = false;
    document.getElementById("restartBtn").style.display = "block";
}

// -------------------------------------------
// RESTART FUNCTION (100% WORKING)
// -------------------------------------------
function restartGame() {
    cancelAnimationFrame(gameLoopID);

    score = 0;
    lives = 3;
    level = 1;

    document.getElementById("score").innerText = score;
    document.getElementById("lives").innerText = lives;
    document.getElementById("level").innerText = level;

    enemy.x = Math.random() * 360;
    enemy.y = -40;

    gameRunning = true;
    document.getElementById("restartBtn").style.display = "none";

    gameLoop();
}

document.getElementById("restartBtn").addEventListener("click", restartGame);

// -------------------------------------------
// PLAYER MOVEMENT
// -------------------------------------------
document.addEventListener("keydown", (e) => {
    if (e.key === "ArrowLeft") player.x -= player.speed;
    if (e.key === "ArrowRight") player.x += player.speed;

    if (player.x < 0) player.x = 0;
    if (player.x + player.w > 400) player.x = 360;
});

// -------------------------------------------
// MENU BUTTON
// -------------------------------------------
document.getElementById("menuBtn").onclick = () => {
    window.location.href = "seite3.html";
};

// -------------------------------------------
// START GAME
// -------------------------------------------
gameLoop();
</script>

</body>
</html>

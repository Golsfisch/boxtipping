<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BoxTipping Ultimate</title>
<style>
body {margin:0; overflow:hidden; font-family:Arial; background:#111; color:white; user-select:none;}
header{text-align:center;padding:10px;font-size:24px;font-weight:bold;}
#infoBox{position:absolute;top:10px;left:10px;background:rgba(0,0,0,0.4);padding:8px 15px;border-radius:8px;font-size:16px;}
canvas{display:block;margin:0 auto;background:rgba(0,0,0,0.2);border:2px solid white;border-radius:10px;backdrop-filter:blur(4px);}
#restartBtn, #toPage2Btn{
  display:block;
  margin:10px auto;
  padding:12px 20px;
  font-size:18px;
  border:none;
  border-radius:10px;
  cursor:pointer;
}
#restartBtn{background:orange; display:none;}
#toPage2Btn{background:#4CAF50;}
</style>
</head>
<body>

<header>BoxTipping Ultimate</header>
<div id="infoBox">Score: 0 | Lives: 3 | Level: 1</div>

<canvas id="gameCanvas" width="400" height="700"></canvas>

<button id="restartBtn">Restart</button>
<button id="toPage2Btn">Zur BoxTipping (Seite 2)</button>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const restartBtn = document.getElementById("restartBtn");
const toPage2Btn = document.getElementById("toPage2Btn");
const info = document.getElementById("infoBox");

// --- STATE ---
let score = 0, lives = 3, level = 1;
let gameOver = false;

// --- PLAYER ---
let player = {x: canvas.width/2-25, y: canvas.height-120, size:50};

// --- ENEMY ---
class Enemy {
  constructor(){this.reset();}
  reset(){this.size=40; this.x=Math.random()*(canvas.width-40); this.y=-Math.random()*400-40; this.speed=2+level*0.5;}
  draw(){ctx.fillStyle="yellow"; ctx.fillRect(this.x,this.y,this.size,this.size);}
  update(){ 
    this.y+=this.speed; 
    if(this.y>canvas.height)this.reset(); 
    if(collide(player,this)){lives--; this.reset(); if(lives<=0) triggerGameOver();}
  }
}
let enemies=[];
function spawnEnemies(){enemies=[]; for(let i=0;i<6+level*2;i++) enemies.push(new Enemy()); }
spawnEnemies();

// --- COLLISION ---
function collide(a,b){ return !(a.x+a.size<b.x || a.x>b.x+b.size || a.y+a.size<b.y || a.y>b.y+b.size); }

// --- PLAYER MOVE ---
document.addEventListener("mousemove", e=>{
  const rect = canvas.getBoundingClientRect();
  player.x = Math.min(Math.max(e.clientX - rect.left - player.size/2,0), canvas.width - player.size);
});
document.addEventListener("touchmove", e=>{
  const rect = canvas.getBoundingClientRect();
  player.x = e.touches[0].clientX - rect.left - player.size/2;
  if(player.x<0) player.x=0;
  if(player.x>canvas.width-player.size) player.x=canvas.width-player.size;
  e.preventDefault();
});

// --- GAME OVER ---
function triggerGameOver(){
  gameOver=true;
  restartBtn.style.display="block";
}

// --- RESTART ---
restartBtn.onclick = () => {
  score=0; lives=3; level=1; gameOver=false;
  spawnEnemies();
  restartBtn.style.display="none";
  info.textContent = `Score: ${Math.floor(score)} | Lives: ${lives} | Level: ${level}`;
};

// --- BUTTON ZUR SEITE2 ---
toPage2Btn.onclick = () => { window.location.href="seite2.html"; };

// --- BACKGROUND STARS ---
let stars=[]; for(let i=0;i<150;i++) stars.push({x:Math.random()*400, y:Math.random()*700, speed:0.5+Math.random()*1});
function drawStars(){ ctx.fillStyle="white"; stars.forEach(s=>{ctx.fillRect(s.x,s.y,2,2); s.y+=s.speed; if(s.y>700){s.y=0;s.x=Math.random()*400;}});}

// --- GAME LOOP ---
function gameLoop(){
  ctx.clearRect(0,0,400,700);
  drawStars();

  // PLAYER
  ctx.fillStyle="red";
  ctx.fillRect(player.x, player.y, player.size, player.size);

  // ENEMIES
  enemies.forEach(e=>{e.update(); e.draw();});

  // SCORE & LEVEL
  if(!gameOver) score += 0.05;
  if(score > level*50 && level<4 && !gameOver){ level++; spawnEnemies(); }

  info.textContent = `Score: ${Math.floor(score)} | Lives: ${lives} | Level: ${level}`;

  requestAnimationFrame(gameLoop);
}

// --- START LOOP ---
gameLoop();
</script>

</body>
</html>

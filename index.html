<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Box's Mysterium - Gun & Bombs</title>
<style>
body{margin:0;font-family:sans-serif;overflow:hidden;user-select:none;-webkit-user-select:none;-moz-user-select:none;}
header{width:100%;text-align:center;padding:15px;font-size:24px;font-weight:bold;display:flex;justify-content:center;align-items:center;gap:10px;}
section{width:100%;height:100vh;display:none;flex-direction:column;align-items:center;justify-content:center;position:relative;}
canvas{border:2px solid #fff;border-radius:10px;margin-top:10px;background:#111;}
#info{position:absolute;top:20px;left:10px;font-size:18px;background:rgba(0,0,0,0.3);padding:5px 10px;border-radius:5px;color:#fff;}
#weapons{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);display:flex;gap:10px;z-index:100;}
.weaponBtn{padding:10px 15px;border:none;border-radius:5px;font-weight:bold;cursor:pointer;}
#laserBtn{background:red;color:#fff;}
#bombBtn{background:blue;color:#fff;}
#freezeBtn{background:cyan;color:#000;}
#restartBtn{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:none;padding:10px 20px;background:lime;color:#000;border:none;border-radius:5px;}
#brand{position:absolute;bottom:10px;left:10px;font-size:14px;color:#888;}
</style>
</head>
<body>
<header>Box's Mysterium ðŸ”«</header>
<section id="gameSection" style="display:flex;">
<div id="info">Score:0 | Lives:3</div>
<canvas id="gameCanvas" width="360" height="640"></canvas>
<div id="weapons">
<button id="laserBtn" class="weaponBtn">Gun</button>
<button id="bombBtn" class="weaponBtn">Bomb</button>
<button id="freezeBtn" class="weaponBtn">Freeze</button>
</div>
<div id="brand">@thesafe</div>
<button id="restartBtn">Restart</button>
</section>

<script>
const canvas=document.getElementById('gameCanvas');
const ctx=canvas.getContext('2d');
const info=document.getElementById('info');
const restartBtn=document.getElementById('restartBtn');

let lives=3, score=0, gameOver=false, player=null, enemies=[], bombs=[], bullets=[];
const playerSize=50;

// --- PLAYER ---
class Player{
    constructor(){this.x=canvas.width/2-playerSize/2;this.y=canvas.height-100;this.size=playerSize; this.gunActive=false; this.gunEndTime=0;}
    draw(){ctx.fillStyle='red';ctx.fillRect(this.x,this.y,this.size,this.size);}
}
player=new Player();

// --- ENEMIES ---
class Enemy{
    constructor(){this.size=40; this.x=Math.random()*(canvas.width-40); this.y=-this.size; this.speed=2+Math.random()*1.5;}
    draw(){ctx.fillStyle='yellow';ctx.fillRect(this.x,this.y,this.size,this.size);}
    update(){this.y+=this.speed;if(this.y+this.size>=player.y && this.y<=player.y+player.size && this.x+this.size>=player.x && this.x<=player.x+player.size){lives--; this.y=-this.size; this.x=Math.random()*(canvas.width-this.size); if(lives<=0){gameOver=true; restartBtn.style.display='block';}}if(this.y>canvas.height){this.y=-this.size; this.x=Math.random()*(canvas.width-this.size);}}
}
function spawnEnemies(){enemies=[];for(let i=0;i<5;i++)enemies.push(new Enemy());}
spawnEnemies();

// --- BULLETS (GUN) ---
class Bullet{constructor(x,y){this.x=x;this.y=y; this.radius=5; this.speed=8;} draw(){ctx.fillStyle='red'; ctx.beginPath(); ctx.arc(this.x,this.y,this.radius,0,Math.PI*2);ctx.fill();}
update(){this.y-=this.speed; enemies.forEach((e,i)=>{if(this.x>e.x && this.x<e.x+e.size && this.y>e.y && this.y<e.y+e.size){score++;enemies[i].y=-enemies[i].size;enemies[i].x=Math.random()*(canvas.width-enemies[i].size);}});}}
}

// --- BOMB ---
class Bomb{constructor(x,y){this.x=x;this.y=y; this.radius=10; this.timer=2000; this.start=Date.now(); this.exploded=false;} draw(){ctx.fillStyle='blue'; ctx.beginPath(); ctx.arc(this.x,this.y,this.radius,0,Math.PI*2);ctx.fill();} update(){if(!this.exploded && Date.now()-this.start>=this.timer){this.exploded=true; this.explode();}} explode(){ctx.fillStyle='rgba(0,255,255,0.5)';ctx.beginPath();ctx.arc(this.x,this.y,canvas.width/3,0,Math.PI*2);ctx.fill(); enemies.forEach((e,i)=>{if(Math.abs(e.x+e.size/2-this.x)<canvas.width/3 && Math.abs(e.y+e.size/2-this.y)<canvas.width/3){score++; e.y=-e.size; e.x=Math.random()*(canvas.width-e.size);}}); setTimeout(()=>{bombs.shift();},300);}}
}

// --- MOUSE FOR BOMB DRAG ---
let dragging=false; let dragBomb=null;
canvas.addEventListener('mousedown',(e)=>{dragging=true; dragBomb={x:e.offsetX,y:e.offsetY,bomb:new Bomb(e.offsetX,e.offsetY)}; bombs.push(dragBomb.bomb);});
canvas.addEventListener('mousemove',(e)=>{if(dragging && dragBomb){dragBomb.bomb.x=e.offsetX; dragBomb.bomb.y=e.offsetY;}});
canvas.addEventListener('mouseup',(e)=>{dragging=false; dragBomb=null;});

// --- WEAPONS ---
document.getElementById('laserBtn').addEventListener('click',()=>{
    player.gunActive=true;
    player.gunEndTime=Date.now()+4500;
});
document.getElementById('bombBtn').addEventListener('click',()=>{}); // Drag handled by mouse
document.getElementById('freezeBtn').addEventListener('click',()=>{enemies.forEach(e=>{e.speed=0;}); setTimeout(()=>{enemies.forEach(e=>{e.speed=2+Math.random()*1.5;});},3000);});

// --- GAME LOOP ---
function gameLoop(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    player.draw();
    enemies.forEach(e=>{e.update(); e.draw();});
    // Bullets
    if(player.gunActive){
        if(Date.now()<player.gunEndTime){bullets.push(new Bullet(player.x+player.size/2,player.y));}
        else{player.gunActive=false;}
    }
    bullets.forEach((b,i)=>{b.update();b.draw(); if(b.y<0) bullets.splice(i,1);});
    // Bombs
    bombs.forEach(b=>{b.update(); b.draw();});
    info.textContent=`Score:${score} | Lives:${lives}`;
    if(!gameOver) requestAnimationFrame(gameLoop);
}
gameLoop();

// --- RESTART ---
restartBtn.addEventListener('click',()=>{lives=3;score=0;gameOver=false;bullets=[];bombs=[];spawnEnemies();restartBtn.style.display='none';});
</script>
</body>
</html>
